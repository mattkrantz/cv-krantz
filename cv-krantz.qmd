---
format:
  pdf:
    toc: false
    number-sections: false
    colorlinks: true
    documentclass: scrartcl
    papersize: letter
    pdf-engine: xelatex
    fontsize: 11pt
    geometry:
      - margin=1in
      - heightrounded
    include-in-header:
      - preamble.tex
execute:
  warning: false
  echo: false
  message: false
  eval: true
---

```{r}
#| name: setup
#| include: false
#| message: false
#| eval: true

knitr::opts_chunk$set(
  fig.path = "figs/",
  fig.width = 7.252,
  fig.height = 4,
  comment = "#>",
  fig.retina = 3
)

source("functions.R")
```

\par\centering{\LARGE{Matthew Steven Krantz, MD}}
\par\centering{Division of Allergy, Pulmonary, and Critical Care Medicine}
\vspace{-5pt}
\par\centering{Vanderbilt University Medical Center}
\vspace{-5pt}
\par\centering{T-1218 Medical Center North}
\vspace{-5pt}
\par\centering{1161 21st Ave. S. Nashville, TN 37232-2650}
\vspace{-5pt}
\par\centering{{\large\Telefon} +1 (615) 322-6943}
\vspace{-5pt}
\par\centering{{\large\Letter} matthew.s.krantz@vumc.org}
\vspace{-5pt}
\par\centering{\href{http://www.mattkrantz.com}{mattkrantz.com}}

\vspace{-10pt}

# Education

\vspace{-10pt}
\begin{longtable}{llp{15cm}}
2012 & BS & University of North Carolina, Chapel Hill, NC\\
 & & \hspace{2em}Major - Biology with distinction\\
 & & \hspace{2em}Minors - Chemistry, Writing for the Screen and Stage\\[5pt]

2016 & MD & University of North Carolina School of Medicine, Chapel Hill, NC\\[5pt]
\end{longtable}

\vspace{-10pt}

# Post-Graduate Training

\vspace{-10pt}
\begin{longtable}{llp{15cm}}
2016 - 2020 & Internship/Residency & \\
 & Internal Medicine/Pediatrics & \\
 & Vanderbilt University Medical Center &\\
 & Nashville, TN\\[5pt]

2020 - 2024 & Fellowship & \\
 & Allergy/Immunology & \\
 & Vanderbilt University Medical Center &\\
 & Nashville, TN\\[5pt]
\end{longtable}

\vspace{-10pt}

# Research Interests
\vspace{-10pt}
- **Immunogenomics**

\vspace{-10pt}

# Teaching Interests
\vspace{-10pt}

- **Clinical Drug Allergy**:

# Academic Appointments

\vspace{-10pt}
\begin{longtable}{llp{15cm}}
2025 - Present & Assistant Professor of Medicine and Biomedical Informatics &\\
 & Vanderbilt University, Nashville, TN &\\[5pt]

2024 - 2025 & Instructor in Medicine and Biomedical Informatics\\
 & Vanderbilt University, Nashville, TN &\\
\end{longtable}

\vspace{-10pt}

# Licensure and Certification

\vspace{-10pt}

```{r}
library(dplyr)
library(here)
licensure_certifications <- read.csv(here("data", "licensure-certification.csv")) %>%
    arrange(desc(year_start)) %>%
  mutate(citation = paste0(description, " (", year_start, "-", year_end, ")"))
```

```{r}
#| results: asis

licensure_certifications %>% 
  pull(citation) %>% 
  make_bullet_list()
```

# Professional Organizations

```{r}
library(dplyr)
library(here)
professional_organizations <- read.csv(here("data", "professional-organizations.csv")) %>%
  mutate(citation = paste0(description))
```

```{r}
#| results: asis

professional_organizations %>% 
  pull(citation) %>% 
  make_bullet_list()
```

# Professional Activities

## Intramural
```{r}
library(dplyr)
library(here)
intramural <- read.csv(here("data", "professional-activities.csv")) %>%
    filter(category=="intramural") %>%
    arrange(desc(year_start)) %>%
  mutate(citation = paste0(description, " (", year_start, "-", year_end, ")"))
```

```{r}
#| results: asis

intramural %>% 
  pull(citation) %>% 
  make_bullet_list()
```

## Extramural

```{r}
library(dplyr)
library(here)
extramural <- read.csv(here("data", "professional-activities.csv")) %>%
    filter(category=="extramural") %>%
    arrange(desc(year_start)) %>%
  mutate(citation = paste0(description, " (", year_start, "-", year_end, ")"))
```

```{r}
#| results: asis

extramural %>% 
  pull(citation) %>% 
  make_bullet_list()
```

## Scientific Reviewer for Peer-Reviewed Journals

```{r}
library(dplyr)
library(here)
peer_review <- read.csv(here("data", "peer-review.csv")) %>%
  mutate(citation = paste0(description))
```

```{r}
#| results: asis

peer_review %>% 
  pull(citation) %>% 
  make_bullet_list()
```

# Honors, Awards, and Recognitions

```{r}
library(dplyr)
library(here)
awards <- read.csv(here("data", "honors-awards.csv")) %>% 
  arrange(desc(date)) %>% 
  mutate(citation = paste0(description, " (", date, ")"))
```

```{r}
#| results: asis

awards %>% 
  pull(citation) %>% 
  make_bullet_list()
```

# Teaching Activities

# Research Program

## Current Research Grants & Contracts Funded

```{r}
library(dplyr)
library(here)
library(lubridate)
grants <- read.csv(here('data', 'grants.csv')) %>%
  mutate(
      project_start_date = as.Date(project_start_date, format="%m/%d/%y"),
      project_end_date = as.Date(project_end_date, format="%m/%d/%y"),
    project_start_date_formatted = format(project_start_date, "%m/%d/%y"),
    project_end_date_formatted = format(project_end_date, "%m/%d/%y"),
      title = enquote(paste0('[', title, ']', '(', url, ')')),
    citation = paste0(id, ". ", title, ". Source of Support: ", source_of_support, ". ", "PI: ", pi_name, ". Total Award Amount: ", budget_total, ". Project Start and End Date: ", project_start_date_formatted, " - ", project_end_date_formatted)) %>% arrange(desc(project_end_date))
```

```{r}
#| results: asis
grants %>% pull(citation) %>% make_ordered_list()
```

# Articles in Peer-Reviewed Journals

## Original Research

```{r}
library(dplyr)
library(here)
publications <- read.csv(here('data', 'publications.csv')) %>%
  mutate(
      epub_date = as.Date(epub_date, format = "%m/%d/%y"),
      author = str_replace(author, "\\bKrantz MS\\b", "**Krantz MS**"),
    journal  = ifelse(is.na(journal), '', paste0('_', journal, '_.')),
    number   = ifelse(number=='', '', paste0(number, '.')),
    PMID    = ifelse(number=='', '', paste0("PMID: ", PMID, ".")),
    PMCID   = ifelse(PMCID=='', '', paste0("PMCID: ", PMCID, ".")),
    doi      = ifelse(
               doi=='', '',
               paste0('DOI: [', doi, '](', 'https://doi.org/', doi, ')')),
    title    = title,
    citation = paste0(author, ". ", title, ". ", journal, " ", date, ";", number, " ", doi, ". ", PMID, " ", PMCID)
  ) %>% 
  arrange(desc(epub_date))
```

```{r}
#| results: asis

make_ordered_list_filtered(publications, "original_research")
```

## Reviews

```{r}
#| results: asis

make_ordered_list_filtered(publications, "reviews")
```

## Invited Editorials

```{r}
#| results: asis

make_ordered_list_filtered(publications, "invited_editorials")
```

## Case Reports

```{r}
#| results: asis

make_ordered_list_filtered(publications, "case_reports")
```

# Book Chapters

```{r}
book_chapters <- read.csv(here('data', 'book-chapters.csv')) %>%
  mutate(
      author = str_replace(author, "\\bKrantz MS\\b", "**Krantz MS**"),
      book_title  = ifelse(is.na(book_title), '', paste0('_', book_title, '_')),
      chapter_title=enquote(chapter_title),
    citation = paste0(author, ". ", "(", date, ") ", chapter_title, " in ", editor, " (ed.) ", book_title, ". ", place, ": ", publisher, ".")
  ) %>% 
  arrange(desc(date))
```

```{r}
#| results: asis

make_ordered_list_filtered(book_chapters, "book_chapters")
```

# Graphic Medicine


```{r}
graphic_medicine <- read.csv(here('data', 'graphic-medicine.csv')) %>%
  mutate(
      epub_date = as.Date(epub_date, format = "%m/%d/%y"),
      author = str_replace(author, "\\bKrantz MS\\b", "**Krantz MS**"),
    journal  = ifelse(is.na(journal), '', paste0('_', journal, '_.')),
    number   = ifelse(is.na(number), '', paste0(number, '.')),
    PMCID   = ifelse(is.na(number), '', PMCID),
    doi      = ifelse(
               is.na(doi), '',
               paste0('DOI: [', doi, '](', 'https://doi.org/', doi, ')')),
    title    = title,
    citation = paste0(author, ". ", title, ". ", journal, " ", date, ";", number, " ", doi, ". ", "PMID: ", PMID, "; ", "PMCID: ", PMCID, ".")
  ) %>% 
  arrange(desc(epub_date))
```

```{r}
#| results: asis

make_ordered_list_filtered(graphic_medicine, "graphic_medicine")
```

# Media

```{r}
media <- read.csv(here('data', 'media.csv')) %>%
  arrange(desc(date)) %>%
  mutate(
      date = format(date, format = "%b %d, %Y"),
      outlet = paste0("**", outlet, "**"),
      citation = paste0(date, ", ", outlet, ": ", post, '.')
  )


```

```{r}
#| results: asis

media %>% 
  pull(citation) %>% 
  make_ordered_list()
```

# Presentations

```{r}
presentations <- read.csv(here('data', 'presentations.csv')) %>%
  arrange(desc(date)) %>% 
  mutate(
    with = ifelse(is.na(with), '', paste0(', with ', with)),
    title = paste0(enquote(title), with),
    title = ifelse(is.na(series), title, paste(title, series, sep = '. ')),
    date = paste0(format(as.Date(date), format = "%b %d, %Y"), '.'),
    citation = paste(title, host, location, date, sep = '. ')
  )
```

## Invited Speaker

```{r}
#| results: asis

make_ordered_list_filtered(presentations, "invited")
```

\vspace{-10pt}
